      INTEGER FUNCTION DEFTOK (TOKEN, TOKSIZ)
      INTEGER TOKEN (100)
      INTEGER TOKSIZ
      COMMON /CDEFIO/ BP, BUF (4096)
      INTEGER BP
      INTEGER BUF
      COMMON /CFNAME/ FCNAME (30)
      INTEGER FCNAME
      COMMON /CFOR/ FORDEP, FORSTK (200)
      INTEGER FORDEP
      INTEGER FORSTK
      COMMON /CGOTO/ XFER
      INTEGER XFER
      COMMON /CLABEL/ LABEL, RETLAB, MEMFLG, COL, LOGIC0
      INTEGER LABEL
      INTEGER RETLAB
      INTEGER MEMFLG
      INTEGER COL
      INTEGER LOGIC0
      COMMON /CLINE/ LEVEL, LINECT (5), INFILE (5), FNAMP, FNAMES ( 150)
      INTEGER LEVEL
      INTEGER LINECT
      INTEGER INFILE
      INTEGER FNAMP
      INTEGER FNAMES
      COMMON /CMACRO/ CP, EP, EVALST (500), DEFTBL
      INTEGER CP
      INTEGER EP
      INTEGER EVALST
      INTEGER DEFTBL
      COMMON /COUTLN/ OUTP, OUTBUF (74)
      INTEGER OUTP
      INTEGER OUTBUF
      COMMON /CSBUF/ SBP, SBUF(2048), SMEM(240)
      INTEGER SBP
      INTEGER SBUF
      INTEGER SMEM
      COMMON /CSWTCH/ SWTOP, SWLAST, SWSTAK(1000), SWVNUM, SWVLEV, SWVST
     *K(10), SWINRG
      INTEGER SWTOP
      INTEGER SWLAST
      INTEGER SWSTAK
      INTEGER SWVNUM
      INTEGER SWVLEV
      INTEGER SWVSTK
      INTEGER SWINRG
      COMMON /CKWORD/ RKWTBL
      INTEGER RKWTBL
      COMMON /CLNAME/ FKWTBL, NAMTBL, GENTBL, ERRTBL, XPPTBL
      INTEGER FKWTBL
      INTEGER NAMTBL
      INTEGER GENTBL
      INTEGER ERRTBL
      INTEGER XPPTBL
      COMMON /ERCHEK/ ERNAME, BODY, ESP, ERRSTK(30)
      INTEGER ERNAME
      INTEGER BODY
      INTEGER ESP
      INTEGER ERRSTK
      INTEGER MEM( 60000)
      COMMON/CDSMEM/MEM
      INTEGER T, C, DEFN (2048), MDEFN (2048)
      INTEGER GTOK
      INTEGER EQUAL
      INTEGER AP, ARGSTK (100), CALLST (50), NLB, PLEV (50), IFL
      INTEGER LUDEF, PUSH, IFPARM
      INTEGER BALP(3)
      INTEGER PSWRG(22)
      DATA BALP(1)/40/,BALP(2)/41/,BALP(3)/-2/
      DATA PSWRG(1)/115/,PSWRG(2)/119/,PSWRG(3)/105/,PSWRG(4)/116/,PSWRG
     *(5)/99/,PSWRG(6)/104/,PSWRG(7)/95/,PSWRG(8)/110/,PSWRG(9)/111/,PSW
     *RG(10)/95/,PSWRG(11)/114/,PSWRG(12)/97/,PSWRG(13)/110/,PSWRG(14)/1
     *03/,PSWRG(15)/101/,PSWRG(16)/95/,PSWRG(17)/99/,PSWRG(18)/104/,PSWR
     *G(19)/101/,PSWRG(20)/99/,PSWRG(21)/107/,PSWRG(22)/-2/
      CP = 0
      AP = 1
      EP = 1
      T = GTOK (TOKEN, TOKSIZ)
23000 IF (.NOT.(T .NE. -1))GOTO 23002
      IF (.NOT.(T .EQ. -9))GOTO 23003
      IF (.NOT.(LUDEF (TOKEN, DEFN, DEFTBL) .EQ. 0))GOTO 23005
      IF (.NOT.(CP .EQ. 0))GOTO 23007
      GOTO 23002
23007 CONTINUE
      CALL PUTTOK (TOKEN)
23008 CONTINUE
      GOTO 23006
23005 CONTINUE
      IF (.NOT.(DEFN (1) .EQ. -4))GOTO 23009
      CALL GETDEF (TOKEN, TOKSIZ, DEFN, 2048)
      CALL ENTDEF (TOKEN, DEFN, DEFTBL)
      GOTO 23010
23009 CONTINUE
      IF (.NOT.(DEFN (1) .EQ. -15 .OR. DEFN (1) .EQ. -16))GOTO 23011
      C = DEFN (1)
      CALL GETDEF (TOKEN, TOKSIZ, DEFN, 2048)
      IFL = LUDEF (TOKEN, MDEFN, DEFTBL)
      IF (.NOT.((IFL .EQ. 1 .AND. C .EQ. -15) .OR. (IFL .EQ. 0 .AND. C .
     *EQ. -16)))GOTO 23013
      CALL PBSTR (DEFN)
23013 CONTINUE
      GOTO 23012
23011 CONTINUE
      IF (.NOT.(DEFN(1) .EQ. -17 .AND. CP .EQ. 0))GOTO 23015
      IF (.NOT.(GTOK (DEFN, 2048) .EQ. 32))GOTO 23017
      IF (.NOT.(GTOK (DEFN, 2048) .EQ. -9))GOTO 23019
      IF (.NOT.(EQUAL (DEFN, PSWRG) .EQ. 1))GOTO 23021
      SWINRG = 1
      GOTO 23022
23021 CONTINUE
      GOTO 10
23022 CONTINUE
      GOTO 23020
23019 CONTINUE
10    CALL PBSTR (DEFN)
      CALL PUTBAK (32)
      GOTO 23002
23020 CONTINUE
      GOTO 23018
23017 CONTINUE
      CALL PBSTR (DEFN)
      GOTO 23002
23018 CONTINUE
      GOTO 23016
23015 CONTINUE
      CP = CP + 1
      IF (.NOT.(CP .GT. 50))GOTO 23023
      CALL BADERR (20Hcall stack overflow.)
23023 CONTINUE
      CALLST (CP) = AP
      AP = PUSH (EP, ARGSTK, AP)
      CALL PUTTOK (DEFN)
      CALL PUTCHR (-2)
      AP = PUSH (EP, ARGSTK, AP)
      CALL PUTTOK (TOKEN)
      CALL PUTCHR (-2)
      AP = PUSH (EP, ARGSTK, AP)
      T = GTOK (TOKEN, TOKSIZ)
      IF (.NOT.(T .EQ. 32))GOTO 23025
      T = GTOK (TOKEN, TOKSIZ)
      CALL PBSTR (TOKEN)
      IF (.NOT.(T .NE. 40))GOTO 23027
      CALL PUTBAK (32)
23027 CONTINUE
      GOTO 23026
23025 CONTINUE
      CALL PBSTR (TOKEN)
23026 CONTINUE
      IF (.NOT.(T .NE. 40))GOTO 23029
      CALL PBSTR (BALP)
      GOTO 23030
23029 CONTINUE
      IF (.NOT.(IFPARM (DEFN) .EQ. 0))GOTO 23031
      CALL PBSTR (BALP)
23031 CONTINUE
23030 CONTINUE
      PLEV (CP) = 0
23016 CONTINUE
23012 CONTINUE
23010 CONTINUE
23006 CONTINUE
      GOTO 23004
23003 CONTINUE
      IF (.NOT.(T .EQ. -69))GOTO 23033
      NLB = 1
23035 CONTINUE
      T = GTOK (TOKEN, TOKSIZ)
      IF (.NOT.(T .EQ. -69))GOTO 23038
      NLB = NLB + 1
      GOTO 23039
23038 CONTINUE
      IF (.NOT.(T .EQ. -68))GOTO 23040
      NLB = NLB - 1
      IF (.NOT.(NLB .EQ. 0))GOTO 23042
      GOTO 23037
23042 CONTINUE
      GOTO 23041
23040 CONTINUE
      IF (.NOT.(T .EQ. -1))GOTO 23044
      CALL BADERR (14HEOF in string.)
23044 CONTINUE
23041 CONTINUE
23039 CONTINUE
      CALL PUTTOK (TOKEN)
23036 GOTO 23035
23037 CONTINUE
      GOTO 23034
23033 CONTINUE
      IF (.NOT.(CP .EQ. 0))GOTO 23046
      GOTO 23002
23046 CONTINUE
      IF (.NOT.(T .EQ. 40))GOTO 23048
      IF (.NOT.(PLEV (CP) .GT. 0))GOTO 23050
      CALL PUTTOK (TOKEN)
23050 CONTINUE
      PLEV (CP) = PLEV (CP) + 1
      GOTO 23049
23048 CONTINUE
      IF (.NOT.(T .EQ. 41))GOTO 23052
      PLEV (CP) = PLEV (CP) - 1
      IF (.NOT.(PLEV (CP) .GT. 0))GOTO 23054
      CALL PUTTOK (TOKEN)
      GOTO 23055
23054 CONTINUE
      CALL PUTCHR (-2)
      CALL EVALR (ARGSTK, CALLST (CP), AP - 1)
      AP = CALLST (CP)
      EP = ARGSTK (AP)
      CP = CP - 1
23055 CONTINUE
      GOTO 23053
23052 CONTINUE
      IF (.NOT.(T .EQ. 44 .AND. PLEV (CP) .EQ. 1))GOTO 23056
      CALL PUTCHR (-2)
      AP = PUSH (EP, ARGSTK, AP)
      GOTO 23057
23056 CONTINUE
      CALL PUTTOK (TOKEN)
23057 CONTINUE
23053 CONTINUE
23049 CONTINUE
23047 CONTINUE
23034 CONTINUE
23004 CONTINUE
23001 T = GTOK (TOKEN, TOKSIZ)
      GOTO 23000
23002 CONTINUE
      DEFTOK = T
      IF (.NOT.(T .EQ. -9))GOTO 23058
      CALL FOLD (TOKEN)
23058 CONTINUE
      RETURN
      END
C     LOGIC0  LOGICAL_COLUMN

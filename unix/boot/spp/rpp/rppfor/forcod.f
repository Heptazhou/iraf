      SUBROUTINE FORCOD (LAB)
      INTEGER LAB
      COMMON /CDEFIO/ BP, BUF (4096)
      INTEGER BP
      INTEGER BUF
      COMMON /CFNAME/ FCNAME (30)
      INTEGER FCNAME
      COMMON /CFOR/ FORDEP, FORSTK (200)
      INTEGER FORDEP
      INTEGER FORSTK
      COMMON /CGOTO/ XFER
      INTEGER XFER
      COMMON /CLABEL/ LABEL, RETLAB, MEMFLG, COL, LOGIC0
      INTEGER LABEL
      INTEGER RETLAB
      INTEGER MEMFLG
      INTEGER COL
      INTEGER LOGIC0
      COMMON /CLINE/ LEVEL, LINECT (5), INFILE (5), FNAMP, FNAMES ( 150)
      INTEGER LEVEL
      INTEGER LINECT
      INTEGER INFILE
      INTEGER FNAMP
      INTEGER FNAMES
      COMMON /CMACRO/ CP, EP, EVALST (500), DEFTBL
      INTEGER CP
      INTEGER EP
      INTEGER EVALST
      INTEGER DEFTBL
      COMMON /COUTLN/ OUTP, OUTBUF (74)
      INTEGER OUTP
      INTEGER OUTBUF
      COMMON /CSBUF/ SBP, SBUF(2048), SMEM(240)
      INTEGER SBP
      INTEGER SBUF
      INTEGER SMEM
      COMMON /CSWTCH/ SWTOP, SWLAST, SWSTAK(1000), SWVNUM, SWVLEV, SWVST
     *K(10), SWINRG
      INTEGER SWTOP
      INTEGER SWLAST
      INTEGER SWSTAK
      INTEGER SWVNUM
      INTEGER SWVLEV
      INTEGER SWVSTK
      INTEGER SWINRG
      COMMON /CKWORD/ RKWTBL
      INTEGER RKWTBL
      COMMON /CLNAME/ FKWTBL, NAMTBL, GENTBL, ERRTBL, XPPTBL
      INTEGER FKWTBL
      INTEGER NAMTBL
      INTEGER GENTBL
      INTEGER ERRTBL
      INTEGER XPPTBL
      COMMON /ERCHEK/ ERNAME, BODY, ESP, ERRSTK(30)
      INTEGER ERNAME
      INTEGER BODY
      INTEGER ESP
      INTEGER ERRSTK
      INTEGER MEM( 60000)
      COMMON/CDSMEM/MEM
      INTEGER T, TOKEN (100)
      INTEGER GETTOK, GNBTOK
      INTEGER I, J, NLPAR
      INTEGER LENGTH, LABGEN
      INTEGER IFNOT(10)
      INTEGER SERRC0(22)
      DATA IFNOT(1)/105/,IFNOT(2)/102/,IFNOT(3)/32/,IFNOT(4)/40/,IFNOT(5
     *)/46/,IFNOT(6)/110/,IFNOT(7)/111/,IFNOT(8)/116/,IFNOT(9)/46/,IFNOT
     *(10)/-2/
      DATA SERRC0(1)/46/,SERRC0(2)/97/,SERRC0(3)/110/,SERRC0(4)/100/,SER
     *RC0(5)/46/,SERRC0(6)/40/,SERRC0(7)/46/,SERRC0(8)/110/,SERRC0(9)/11
     *1/,SERRC0(10)/116/,SERRC0(11)/46/,SERRC0(12)/120/,SERRC0(13)/101/,
     *SERRC0(14)/114/,SERRC0(15)/102/,SERRC0(16)/108/,SERRC0(17)/103/,SE
     *RRC0(18)/41/,SERRC0(19)/41/,SERRC0(20)/41/,SERRC0(21)/32/,SERRC0(2
     *2)/-2/
      LAB = LABGEN (3)
      CALL OUTCON (0)
      IF (.NOT.(GNBTOK (TOKEN, 100) .NE. 40))GOTO 23000
      CALL SYNERR (19Hmissing left paren.)
      RETURN
23000 CONTINUE
      IF (.NOT.(GNBTOK (TOKEN, 100) .NE. 59))GOTO 23002
      CALL PBSTR (TOKEN)
      CALL OUTTAB
      CALL EATUP
      CALL OUTDWE
23002 CONTINUE
      IF (.NOT.(GNBTOK (TOKEN, 100) .EQ. 59))GOTO 23004
      CALL OUTCON (LAB)
      GOTO 23005
23004 CONTINUE
      CALL PBSTR (TOKEN)
      CALL OUTNUM (LAB)
      CALL OUTTAB
      CALL OUTSTR (IFNOT)
      CALL OUTCH (40)
      NLPAR = 0
23006 IF (.NOT.(NLPAR .GE. 0))GOTO 23007
      T = GETTOK (TOKEN, 100)
      IF (.NOT.(T .EQ. 59))GOTO 23008
      GOTO 23007
23008 CONTINUE
      IF (.NOT.(T .EQ. 40))GOTO 23010
      NLPAR = NLPAR + 1
      GOTO 23011
23010 CONTINUE
      IF (.NOT.(T .EQ. 41))GOTO 23012
      NLPAR = NLPAR - 1
23012 CONTINUE
23011 CONTINUE
      IF (.NOT.(T .EQ. -1))GOTO 23014
      CALL PBSTR (TOKEN)
      RETURN
23014 CONTINUE
      IF (.NOT.(T .EQ. -9))GOTO 23016
      CALL SQUASH (TOKEN)
23016 CONTINUE
      IF (.NOT.(T .NE. 10 .AND. T .NE. 95))GOTO 23018
      CALL OUTSTR (TOKEN)
23018 CONTINUE
      GOTO 23006
23007 CONTINUE
      IF (.NOT.(ERNAME .EQ. 1))GOTO 23020
      CALL OUTSTR (SERRC0)
      GOTO 23021
23020 CONTINUE
      CALL OUTCH (41)
      CALL OUTCH (41)
      CALL OUTCH (32)
23021 CONTINUE
      CALL OUTGO (LAB+2)
      IF (.NOT.(NLPAR .LT. 0))GOTO 23022
      CALL SYNERR (19Hinvalid for clause.)
23022 CONTINUE
23005 CONTINUE
      FORDEP = FORDEP + 1
      J = 1
      I = 1
23024 IF (.NOT.(I .LT. FORDEP))GOTO 23026
      J = J + LENGTH (FORSTK (J)) + 1
23025 I = I + 1
      GOTO 23024
23026 CONTINUE
      FORSTK (J) = -2
      NLPAR = 0
      T = GNBTOK (TOKEN, 100)
      CALL PBSTR (TOKEN)
23027 IF (.NOT.(NLPAR .GE. 0))GOTO 23028
      T = GETTOK (TOKEN, 100)
      IF (.NOT.(T .EQ. 40))GOTO 23029
      NLPAR = NLPAR + 1
      GOTO 23030
23029 CONTINUE
      IF (.NOT.(T .EQ. 41))GOTO 23031
      NLPAR = NLPAR - 1
23031 CONTINUE
23030 CONTINUE
      IF (.NOT.(T .EQ. -1))GOTO 23033
      CALL PBSTR (TOKEN)
      GOTO 23028
23033 CONTINUE
      IF (.NOT.(NLPAR .GE. 0 .AND. T .NE. 10 .AND. T .NE. 95))GOTO 23035
      IF (.NOT.(T .EQ. -9))GOTO 23037
      CALL SQUASH (TOKEN)
23037 CONTINUE
      IF (.NOT.(J + LENGTH (TOKEN) .GE. 200))GOTO 23039
      CALL BADERR (20Hfor clause too long.)
23039 CONTINUE
      CALL SCOPY (TOKEN, 1, FORSTK, J)
      J = J + LENGTH (TOKEN)
23035 CONTINUE
      GOTO 23027
23028 CONTINUE
      LAB = LAB + 1
      CALL INDENT (1)
      CALL ERRGO
      RETURN
      END
C     LOGIC0  LOGICAL_COLUMN
C     SERRC0  SERRCHK

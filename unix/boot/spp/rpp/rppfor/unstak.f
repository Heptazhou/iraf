      SUBROUTINE UNSTAK (SP, LEXTYP, LABVAL, TOKEN)
      INTEGER LABVAL(100), LEXTYP(100)
      INTEGER SP, TOKEN, TYPE
23000 IF (.NOT.(SP .GT. 1))GOTO 23002
      TYPE = LEXTYP(SP)
      IF (.NOT.((TYPE .EQ. -98 .OR. TYPE .EQ. -97) .AND. TOKEN .EQ. -86)
     *)GOTO 23003
      GOTO 23002
23003 CONTINUE
      IF (.NOT.(TYPE .EQ. -99 .OR. TYPE .EQ. -98 .OR. TYPE .EQ. -97))GOT
     *O 23005
      TYPE = 999
23005 CONTINUE
      IF (.NOT.(TYPE .EQ. 123 .OR. TYPE .EQ. -92))GOTO 23007
      GOTO 23002
23007 CONTINUE
      IF (.NOT.(TYPE .EQ. 999 .AND. TOKEN .EQ. -87))GOTO 23009
      GOTO 23002
23009 CONTINUE
      IF (.NOT.(TYPE .EQ. 999))GOTO 23011
      CALL INDENT (-1)
      CALL OUTCON (LABVAL(SP))
      GOTO 23012
23011 CONTINUE
      IF (.NOT.(TYPE .EQ. -87 .OR. TYPE .EQ. -72))GOTO 23013
      IF (.NOT.(SP .GT. 2))GOTO 23015
      SP = SP - 1
23015 CONTINUE
      IF (.NOT.(TYPE .NE. -72))GOTO 23017
      CALL INDENT (-1)
23017 CONTINUE
      CALL OUTCON (LABVAL(SP) + 1)
      GOTO 23014
23013 CONTINUE
      IF (.NOT.(TYPE .EQ. -96))GOTO 23019
      CALL DOSTAT (LABVAL(SP))
      GOTO 23020
23019 CONTINUE
      IF (.NOT.(TYPE .EQ. -95))GOTO 23021
      CALL WHILES (LABVAL(SP))
      GOTO 23022
23021 CONTINUE
      IF (.NOT.(TYPE .EQ. -94))GOTO 23023
      CALL FORS (LABVAL(SP))
      GOTO 23024
23023 CONTINUE
      IF (.NOT.(TYPE .EQ. -93))GOTO 23025
      CALL UNTILS (LABVAL(SP), TOKEN)
23025 CONTINUE
23024 CONTINUE
23022 CONTINUE
23020 CONTINUE
23014 CONTINUE
23012 CONTINUE
23001 SP=SP-1
      GOTO 23000
23002 CONTINUE
      END

      INTEGER FUNCTION GTOK (LEXSTR, TOKSIZ)
      INTEGER LEXSTR (100)
      INTEGER TOKSIZ
      COMMON /CDEFIO/ BP, BUF (4096)
      INTEGER BP
      INTEGER BUF
      COMMON /CFNAME/ FCNAME (30)
      INTEGER FCNAME
      COMMON /CFOR/ FORDEP, FORSTK (200)
      INTEGER FORDEP
      INTEGER FORSTK
      COMMON /CGOTO/ XFER
      INTEGER XFER
      COMMON /CLABEL/ LABEL, RETLAB, MEMFLG, COL, LOGIC0
      INTEGER LABEL
      INTEGER RETLAB
      INTEGER MEMFLG
      INTEGER COL
      INTEGER LOGIC0
      COMMON /CLINE/ LEVEL, LINECT (5), INFILE (5), FNAMP, FNAMES ( 150)
      INTEGER LEVEL
      INTEGER LINECT
      INTEGER INFILE
      INTEGER FNAMP
      INTEGER FNAMES
      COMMON /CMACRO/ CP, EP, EVALST (500), DEFTBL
      INTEGER CP
      INTEGER EP
      INTEGER EVALST
      INTEGER DEFTBL
      COMMON /COUTLN/ OUTP, OUTBUF (74)
      INTEGER OUTP
      INTEGER OUTBUF
      COMMON /CSBUF/ SBP, SBUF(2048), SMEM(240)
      INTEGER SBP
      INTEGER SBUF
      INTEGER SMEM
      COMMON /CSWTCH/ SWTOP, SWLAST, SWSTAK(1000), SWVNUM, SWVLEV, SWVST
     *K(10), SWINRG
      INTEGER SWTOP
      INTEGER SWLAST
      INTEGER SWSTAK
      INTEGER SWVNUM
      INTEGER SWVLEV
      INTEGER SWVSTK
      INTEGER SWINRG
      COMMON /CKWORD/ RKWTBL
      INTEGER RKWTBL
      COMMON /CLNAME/ FKWTBL, NAMTBL, GENTBL, ERRTBL, XPPTBL
      INTEGER FKWTBL
      INTEGER NAMTBL
      INTEGER GENTBL
      INTEGER ERRTBL
      INTEGER XPPTBL
      COMMON /ERCHEK/ ERNAME, BODY, ESP, ERRSTK(30)
      INTEGER ERNAME
      INTEGER BODY
      INTEGER ESP
      INTEGER ERRSTK
      INTEGER MEM( 60000)
      COMMON/CDSMEM/MEM
      INTEGER C
      INTEGER NGETCH
      INTEGER I
      EXTERNAL INDEX
      INTEGER INDEX
      INTEGER DIGITS(37)
      DATA DIGITS(1)/48/,DIGITS(2)/49/,DIGITS(3)/50/,DIGITS(4)/51/,DIGIT
     *S(5)/52/,DIGITS(6)/53/,DIGITS(7)/54/,DIGITS(8)/55/,DIGITS(9)/56/,D
     *IGITS(10)/57/,DIGITS(11)/97/,DIGITS(12)/98/,DIGITS(13)/99/,DIGITS(
     *14)/100/,DIGITS(15)/101/,DIGITS(16)/102/,DIGITS(17)/103/,DIGITS(18
     *)/104/,DIGITS(19)/105/,DIGITS(20)/106/,DIGITS(21)/107/,DIGITS(22)/
     *108/,DIGITS(23)/109/,DIGITS(24)/110/,DIGITS(25)/111/,DIGITS(26)/11
     *2/,DIGITS(27)/113/,DIGITS(28)/114/,DIGITS(29)/115/,DIGITS(30)/116/
     *,DIGITS(31)/117/,DIGITS(32)/118/,DIGITS(33)/119/,DIGITS(34)/120/,D
     *IGITS(35)/121/,DIGITS(36)/122/,DIGITS(37)/-2/
      C = NGETCH (LEXSTR (1))
      IF (.NOT.(C .EQ. 32 .OR. C .EQ. 9))GOTO 23000
      LEXSTR (1) = 32
23002 IF (.NOT.(C .EQ. 32 .OR. C .EQ. 9))GOTO 23003
      C = NGETCH (C)
      GOTO 23002
23003 CONTINUE
      IF (.NOT.(C .EQ. 35))GOTO 23004
23006 IF (.NOT.(NGETCH (C) .NE. 10))GOTO 23007
      GOTO 23006
23007 CONTINUE
23004 CONTINUE
      IF (.NOT.(C .NE. 10))GOTO 23008
      CALL PUTBAK (C)
      GOTO 23009
23008 CONTINUE
      LEXSTR (1) = 10
23009 CONTINUE
      LEXSTR (2) = -2
      GTOK = LEXSTR (1)
      RETURN
23000 CONTINUE
      I = 1
      IF (.NOT.(((65.LE.C.AND.C.LE.90).OR.(97.LE.C.AND.C.LE.122))))GOTO 
     *23010
      GTOK = -9
      IF (.NOT.(C .EQ. 120))GOTO 23012
      C = NGETCH (LEXSTR(2))
      IF (.NOT.(C .EQ. 36))GOTO 23014
      GTOK =  -166
      I = 2
      GOTO 23015
23014 CONTINUE
      CALL PUTBAK (C)
23015 CONTINUE
23012 CONTINUE
23016 IF (.NOT.(I .LT. TOKSIZ - 2))GOTO 23018
      C = NGETCH (LEXSTR(I+1))
      IF (.NOT.(.NOT.((65.LE.C.AND.C.LE.90).OR.(97.LE.C.AND.C.LE.122)) .
     *AND. .NOT.(48.LE.C.AND.C.LE.57) .AND. C .NE. 95))GOTO 23019
      GOTO 23018
23019 CONTINUE
23017 I=I+1
      GOTO 23016
23018 CONTINUE
      CALL PUTBAK (C)
      GOTO 23011
23010 CONTINUE
      IF (.NOT.((48.LE.C.AND.C.LE.57)))GOTO 23021
      I=1
23023 IF (.NOT.(I .LT. TOKSIZ - 2))GOTO 23025
      C = NGETCH (LEXSTR (I + 1))
      IF (.NOT.(.NOT.(48.LE.C.AND.C.LE.57)))GOTO 23026
      GOTO 23025
23026 CONTINUE
23024 I=I+1
      GOTO 23023
23025 CONTINUE
      CALL PUTBAK (C)
      GTOK = 48
      GOTO 23022
23021 CONTINUE
      IF (.NOT.(C .EQ. 91))GOTO 23028
      LEXSTR (1) = 123
      GTOK = 123
      GOTO 23029
23028 CONTINUE
      IF (.NOT.(C .EQ. 93))GOTO 23030
      LEXSTR (1) = 125
      GTOK = 125
      GOTO 23031
23030 CONTINUE
      IF (.NOT.(C .EQ. 36))GOTO 23032
      IF (.NOT.(NGETCH (LEXSTR (2)) .EQ. 40))GOTO 23034
      I = 2
      GTOK = -69
      GOTO 23035
23034 CONTINUE
      IF (.NOT.(LEXSTR (2) .EQ. 41))GOTO 23036
      I = 2
      GTOK = -68
      GOTO 23037
23036 CONTINUE
      CALL PUTBAK (LEXSTR (2))
      GTOK = 36
23037 CONTINUE
23035 CONTINUE
      GOTO 23033
23032 CONTINUE
      IF (.NOT.(C .EQ. 39 .OR. C .EQ. 34))GOTO 23038
      GTOK = C
      I = 2
23040 IF (.NOT.(NGETCH (LEXSTR (I)) .NE. LEXSTR (1)))GOTO 23042
      IF (.NOT.(LEXSTR (I) .EQ. 95))GOTO 23043
      IF (.NOT.(NGETCH (C) .EQ. 10))GOTO 23045
23047 IF (.NOT.(C .EQ. 10 .OR. C .EQ. 32 .OR. C .EQ. 9))GOTO 23048
      C = NGETCH (C)
      GOTO 23047
23048 CONTINUE
      LEXSTR (I) = C
      GOTO 23046
23045 CONTINUE
      CALL PUTBAK (C)
23046 CONTINUE
23043 CONTINUE
      IF (.NOT.(LEXSTR (I) .EQ. 10 .OR. I .GE. TOKSIZ - 1))GOTO 23049
      CALL SYNERR (14Hmissing quote.)
      LEXSTR (I) = LEXSTR (1)
      CALL PUTBAK (10)
      GOTO 23042
23049 CONTINUE
23041 I = I + 1
      GOTO 23040
23042 CONTINUE
      GOTO 23039
23038 CONTINUE
      IF (.NOT.(C .EQ. 35))GOTO 23051
23053 IF (.NOT.(NGETCH (LEXSTR (1)) .NE. 10))GOTO 23054
      GOTO 23053
23054 CONTINUE
      GTOK = 10
      GOTO 23052
23051 CONTINUE
      IF (.NOT.(C .EQ. 62 .OR. C .EQ. 60 .OR. C .EQ. 126 .OR. C .EQ. 33 
     *.OR. C .EQ. 126 .OR. C .EQ. 94 .OR. C .EQ. 61 .OR. C .EQ. 38 .OR. 
     *C .EQ. 124))GOTO 23055
      CALL RELATE (LEXSTR, I)
      GTOK = C
      GOTO 23056
23055 CONTINUE
      GTOK = C
23056 CONTINUE
23052 CONTINUE
23039 CONTINUE
23033 CONTINUE
23031 CONTINUE
23029 CONTINUE
23022 CONTINUE
23011 CONTINUE
      IF (.NOT.(I .GE. TOKSIZ - 1))GOTO 23057
      CALL SYNERR (15Htoken too long.)
23057 CONTINUE
      LEXSTR (I + 1) = -2
      RETURN
      END
C     LOGIC0  LOGICAL_COLUMN

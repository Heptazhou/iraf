      INTEGER FUNCTION GFNARG (NAME, STATE)
      INTEGER NAME (100)
      INTEGER STATE (4)
      INTEGER L
      INTEGER GETARG, GETLIN
      INTEGER FD
      INTEGER RFOPEN
      INTEGER IN1(12)
      INTEGER IN2(12)
      INTEGER IN3(12)
      DATA IN1(1)/47/,IN1(2)/100/,IN1(3)/101/,IN1(4)/118/,IN1(5)/47/,IN1
     *(6)/115/,IN1(7)/116/,IN1(8)/100/,IN1(9)/105/,IN1(10)/110/,IN1(11)/
     *49/,IN1(12)/-2/
      DATA IN2(1)/47/,IN2(2)/100/,IN2(3)/101/,IN2(4)/118/,IN2(5)/47/,IN2
     *(6)/115/,IN2(7)/116/,IN2(8)/100/,IN2(9)/105/,IN2(10)/110/,IN2(11)/
     *50/,IN2(12)/-2/
      DATA IN3(1)/47/,IN3(2)/100/,IN3(3)/101/,IN3(4)/118/,IN3(5)/47/,IN3
     *(6)/115/,IN3(7)/116/,IN3(8)/100/,IN3(9)/105/,IN3(10)/110/,IN3(11)/
     *51/,IN3(12)/-2/
23000 CONTINUE
      IF (.NOT.(STATE (1) .EQ. 1))GOTO 23003
      STATE (1) = 2
      STATE (2) = 1
      STATE (3) = -3
      STATE (4) = 0
      GOTO 23004
23003 CONTINUE
      IF (.NOT.(STATE (1) .EQ. 2))GOTO 23005
      IF (.NOT.(GETARG (STATE (2), NAME, 128) .NE. -1))GOTO 23007
      STATE (1) = 2
      STATE (2) = STATE (2) + 1
      IF (.NOT.(NAME (1) .NE. 45))GOTO 23009
      STATE (4) = STATE (4) + 1
      GFNARG=(-2)
      RETURN
23009 CONTINUE
      IF (.NOT.(NAME (2) .EQ. -2))GOTO 23011
      CALL SCOPY (IN1, 1, NAME, 1)
      STATE (4) = STATE (4) + 1
      GFNARG=(-2)
      RETURN
23011 CONTINUE
      IF (.NOT.(NAME (2) .EQ. 49 .AND. NAME (3) .EQ. -2))GOTO 23013
      CALL SCOPY (IN1, 1, NAME, 1)
      STATE (4) = STATE (4) + 1
      GFNARG=(-2)
      RETURN
23013 CONTINUE
      IF (.NOT.(NAME (2) .EQ. 50 .AND. NAME (3) .EQ. -2))GOTO 23015
      CALL SCOPY (IN2, 1, NAME, 1)
      STATE (4) = STATE (4) + 1
      GFNARG=(-2)
      RETURN
23015 CONTINUE
      IF (.NOT.(NAME (2) .EQ. 51 .AND. NAME (3) .EQ. -2))GOTO 23017
      CALL SCOPY (IN3, 1, NAME, 1)
      STATE (4) = STATE (4) + 1
      GFNARG=(-2)
      RETURN
23017 CONTINUE
      IF (.NOT.(NAME (2) .EQ. 110 .OR. NAME (2) .EQ. 78))GOTO 23019
      STATE (1) = 3
      IF (.NOT.(NAME (3) .EQ. -2))GOTO 23021
      STATE (3) = 0
      GOTO 23022
23021 CONTINUE
      IF (.NOT.(NAME (3) .EQ. 49 .AND. NAME (4) .EQ. -2))GOTO 23023
      STATE (3) = STDIN1
      GOTO 23024
23023 CONTINUE
      IF (.NOT.(NAME (3) .EQ. 50 .AND. NAME (4) .EQ. -2))GOTO 23025
      STATE (3) = STDIN2
      GOTO 23026
23025 CONTINUE
      IF (.NOT.(NAME (3) .EQ. 51 .AND. NAME (4) .EQ. -2))GOTO 23027
      STATE (3) = STDIN3
      GOTO 23028
23027 CONTINUE
      STATE (3) = RFOPEN(NAME (3), 1)
      IF (.NOT.(STATE (3) .EQ. -3))GOTO 23029
      CALL PUTLIN (NAME, 2)
      CALL REMARK (14H:  can't open.)
      STATE (1) = 2
23029 CONTINUE
23028 CONTINUE
23026 CONTINUE
23024 CONTINUE
23022 CONTINUE
      GOTO 23020
23019 CONTINUE
      GFNARG=(-3)
      RETURN
23020 CONTINUE
23018 CONTINUE
23016 CONTINUE
23014 CONTINUE
23012 CONTINUE
23010 CONTINUE
      GOTO 23008
23007 CONTINUE
      STATE (1) = 4
23008 CONTINUE
      GOTO 23006
23005 CONTINUE
      IF (.NOT.(STATE (1) .EQ. 3))GOTO 23031
      L = GETLIN (NAME, STATE (3))
      IF (.NOT.(L .NE. -1))GOTO 23033
      NAME (L) = -2
      STATE (4) = STATE (4) + 1
      GFNARG=(-2)
      RETURN
23033 CONTINUE
      IF (.NOT.(FD .NE. -3 .AND. FD .NE. 0))GOTO 23035
      CALL RFCLOS(STATE (3))
23035 CONTINUE
      STATE (1) = 2
      GOTO 23032
23031 CONTINUE
      IF (.NOT.(STATE (1) .EQ. 4))GOTO 23037
      STATE (1) = 5
      IF (.NOT.(STATE (4) .EQ. 0))GOTO 23039
      CALL SCOPY (IN1, 1, NAME, 1)
      GFNARG=(-2)
      RETURN
23039 CONTINUE
      GOTO 23002
23037 CONTINUE
      IF (.NOT.(STATE (1) .EQ. 5))GOTO 23041
      GOTO 23002
23041 CONTINUE
      CALL ERROR (32Hin gfnarg:  bad state (1) value.)
23042 CONTINUE
23038 CONTINUE
23032 CONTINUE
23006 CONTINUE
23004 CONTINUE
23001 GOTO 23000
23002 CONTINUE
      NAME (1) = -2
      GFNARG=(-1)
      RETURN
      END

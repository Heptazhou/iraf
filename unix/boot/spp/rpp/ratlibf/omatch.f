      INTEGER FUNCTION OMATCH (LIN, I, PAT, J)
      INTEGER LIN (128), PAT (128)
      INTEGER I, J
      INTEGER BUMP
      INTEGER LOCATE
      OMATCH = 0
      IF (.NOT.(LIN (I) .EQ. -2))GOTO 23000
      RETURN
23000 CONTINUE
      BUMP = -1
      IF (.NOT.(PAT (J) .EQ. 97))GOTO 23002
      IF (.NOT.(LIN (I) .EQ. PAT (J + 1)))GOTO 23004
      BUMP = 1
23004 CONTINUE
      GOTO 23003
23002 CONTINUE
      IF (.NOT.(PAT (J) .EQ. 37))GOTO 23006
      IF (.NOT.(I .EQ. 1))GOTO 23008
      BUMP = 0
23008 CONTINUE
      GOTO 23007
23006 CONTINUE
      IF (.NOT.(PAT (J) .EQ. 63))GOTO 23010
      IF (.NOT.(LIN (I) .NE. 10))GOTO 23012
      BUMP = 1
23012 CONTINUE
      GOTO 23011
23010 CONTINUE
      IF (.NOT.(PAT (J) .EQ. 36))GOTO 23014
      IF (.NOT.(LIN (I) .EQ. 10))GOTO 23016
      BUMP = 0
23016 CONTINUE
      GOTO 23015
23014 CONTINUE
      IF (.NOT.(PAT (J) .EQ. 91))GOTO 23018
      IF (.NOT.(LOCATE (LIN (I), PAT, J + 1) .EQ. 1))GOTO 23020
      BUMP = 1
23020 CONTINUE
      GOTO 23019
23018 CONTINUE
      IF (.NOT.(PAT (J) .EQ. 110))GOTO 23022
      IF (.NOT.(LIN (I) .NE. 10 .AND. LOCATE (LIN (I), PAT, J + 1) .EQ. 
     *0))GOTO 23024
      BUMP = 1
23024 CONTINUE
      GOTO 23023
23022 CONTINUE
      CALL ERROR (24Hin omatch: can't happen.)
23023 CONTINUE
23019 CONTINUE
23015 CONTINUE
23011 CONTINUE
23007 CONTINUE
23003 CONTINUE
      IF (.NOT.(BUMP .GE. 0))GOTO 23026
      I = I + BUMP
      OMATCH = 1
23026 CONTINUE
      RETURN
      END

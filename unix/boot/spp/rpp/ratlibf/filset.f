      SUBROUTINE FILSET (DELIM, ARRAY, I, SET, J, MAXSET)
      INTEGER I, J, MAXSET
      INTEGER ARRAY (100), DELIM, SET (MAXSET)
      INTEGER ESC
      INTEGER JUNK
      EXTERNAL INDEX
      INTEGER ADDSET, INDEX
      INTEGER DIGITS(11)
      INTEGER LOWALF(27)
      INTEGER UPALF(27)
      DATA DIGITS(1)/48/,DIGITS(2)/49/,DIGITS(3)/50/,DIGITS(4)/51/,DIGIT
     *S(5)/52/,DIGITS(6)/53/,DIGITS(7)/54/,DIGITS(8)/55/,DIGITS(9)/56/,D
     *IGITS(10)/57/,DIGITS(11)/-2/
      DATA LOWALF(1)/97/,LOWALF(2)/98/,LOWALF(3)/99/,LOWALF(4)/100/,LOWA
     *LF(5)/101/,LOWALF(6)/102/,LOWALF(7)/103/,LOWALF(8)/104/,LOWALF(9)/
     *105/,LOWALF(10)/106/,LOWALF(11)/107/,LOWALF(12)/108/,LOWALF(13)/10
     *9/,LOWALF(14)/110/,LOWALF(15)/111/,LOWALF(16)/112/,LOWALF(17)/113/
     *,LOWALF(18)/114/,LOWALF(19)/115/,LOWALF(20)/116/,LOWALF(21)/117/,L
     *OWALF(22)/118/,LOWALF(23)/119/,LOWALF(24)/120/,LOWALF(25)/121/,LOW
     *ALF(26)/122/,LOWALF(27)/-2/
      DATA UPALF(1)/65/,UPALF(2)/66/,UPALF(3)/67/,UPALF(4)/68/,UPALF(5)/
     *69/,UPALF(6)/70/,UPALF(7)/71/,UPALF(8)/72/,UPALF(9)/73/,UPALF(10)/
     *74/,UPALF(11)/75/,UPALF(12)/76/,UPALF(13)/77/,UPALF(14)/78/,UPALF(
     *15)/79/,UPALF(16)/80/,UPALF(17)/81/,UPALF(18)/82/,UPALF(19)/83/,UP
     *ALF(20)/84/,UPALF(21)/85/,UPALF(22)/86/,UPALF(23)/87/,UPALF(24)/88
     */,UPALF(25)/89/,UPALF(26)/90/,UPALF(27)/-2/
23000 IF (.NOT.(ARRAY (I) .NE. DELIM .AND. ARRAY (I) .NE. -2))GOTO 23002
      IF (.NOT.(ARRAY (I) .EQ. 64))GOTO 23003
      JUNK = ADDSET (ESC (ARRAY, I), SET, J, MAXSET)
      GOTO 23004
23003 CONTINUE
      IF (.NOT.(ARRAY (I) .NE. 45))GOTO 23005
      JUNK = ADDSET (ARRAY (I), SET, J, MAXSET)
      GOTO 23006
23005 CONTINUE
      IF (.NOT.(J .LE. 1 .OR. ARRAY (I + 1) .EQ. -2))GOTO 23007
      JUNK = ADDSET (45, SET, J, MAXSET)
      GOTO 23008
23007 CONTINUE
      IF (.NOT.(INDEX (DIGITS, SET (J - 1)) .GT. 0))GOTO 23009
      CALL DODASH (DIGITS, ARRAY, I, SET, J, MAXSET)
      GOTO 23010
23009 CONTINUE
      IF (.NOT.(INDEX (LOWALF, SET (J - 1)) .GT. 0))GOTO 23011
      CALL DODASH (LOWALF, ARRAY, I, SET, J, MAXSET)
      GOTO 23012
23011 CONTINUE
      IF (.NOT.(INDEX (UPALF, SET (J - 1)) .GT. 0))GOTO 23013
      CALL DODASH (UPALF, ARRAY, I, SET, J, MAXSET)
      GOTO 23014
23013 CONTINUE
      JUNK = ADDSET (45, SET, J, MAXSET)
23014 CONTINUE
23012 CONTINUE
23010 CONTINUE
23008 CONTINUE
23006 CONTINUE
23004 CONTINUE
23001 I = I + 1
      GOTO 23000
23002 CONTINUE
      RETURN
      END

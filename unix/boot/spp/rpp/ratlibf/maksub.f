      INTEGER FUNCTION MAKSUB (ARG, FROM, DELIM, SUB)
      INTEGER ARG (128), DELIM, SUB (128)
      INTEGER FROM
      INTEGER ESC, TYPE
      INTEGER I, J, JUNK
      INTEGER ADDSET
      J = 1
      I = FROM
23000 IF (.NOT.(ARG (I) .NE. DELIM .AND. ARG (I) .NE. -2))GOTO 23002
      IF (.NOT.(ARG (I) .EQ. 38))GOTO 23003
      JUNK = ADDSET (-3, SUB, J, 128)
      JUNK = ADDSET (0, SUB, J, 128)
      GOTO 23004
23003 CONTINUE
      IF (.NOT.(ARG (I) .EQ. 64 .AND. TYPE (ARG (I + 1)) .EQ. 48))GOTO 2
     *3005
      I = I + 1
      JUNK = ADDSET (-3, SUB, J, 128)
      JUNK = ADDSET (ARG (I) - 48, SUB, J, 128)
      GOTO 23006
23005 CONTINUE
      JUNK = ADDSET (ESC (ARG, I), SUB, J, 128)
23006 CONTINUE
23004 CONTINUE
23001 I = I + 1
      GOTO 23000
23002 CONTINUE
      IF (.NOT.(ARG (I) .NE. DELIM))GOTO 23007
      MAKSUB = -3
      GOTO 23008
23007 CONTINUE
      IF (.NOT.(ADDSET (-2, SUB, J, 128) .EQ. 0))GOTO 23009
      MAKSUB = -3
      GOTO 23010
23009 CONTINUE
      MAKSUB = I
23010 CONTINUE
23008 CONTINUE
      RETURN
      END
